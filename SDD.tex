
\documentclass{article}

\usepackage{pgffor}

\usepackage{tikz}
\usetikzlibrary{fit,positioning}
\usetikzlibrary{shapes.multipart}
\usetikzlibrary{positioning}
\usetikzlibrary{shadows}
\usetikzlibrary{calc}
\usepackage{array}
\renewcommand{\arraystretch}{1.1}
\usepackage{tikz}
\usetikzlibrary{shapes.multipart}
\usetikzlibrary{positioning}
\usetikzlibrary{shadows}
\usetikzlibrary{calc}

\usepackage{pdflscape}

\makeatletter
\pgfarrowsdeclare{crow's foot}{crow's foot}
{
    \pgfarrowsleftextend{+-.5\pgflinewidth}%
    \pgfarrowsrightextend{+.5\pgflinewidth}%
}
{
    \pgfutil@tempdima=0.6pt%
    \pgfsetdash{}{+0pt}%
    \pgfsetmiterjoin%
    \pgfpathmoveto{\pgfqpoint{0pt}{-9\pgfutil@tempdima}}%
    \pgfpathlineto{\pgfqpoint{-13\pgfutil@tempdima}{0pt}}%
    \pgfpathlineto{\pgfqpoint{0pt}{9\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{0\pgfutil@tempdima}{0\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{-8pt}{-6pt}}% 
    \pgfpathlineto{\pgfqpoint{-8pt}{-6pt}}%  
    \pgfpathlineto{\pgfqpoint{-8pt}{6pt}}% 
    \pgfusepathqstroke%
}

\pgfarrowsdeclare{omany}{omany}
{
    \pgfarrowsleftextend{+-.5\pgflinewidth}%
    \pgfarrowsrightextend{+.5\pgflinewidth}%
}
{
    \pgfutil@tempdima=0.6pt%
    \pgfsetdash{}{+0pt}%
    \pgfsetmiterjoin%
    \pgfpathmoveto{\pgfqpoint{0pt}{-9\pgfutil@tempdima}}%
    \pgfpathlineto{\pgfqpoint{-13\pgfutil@tempdima}{0pt}}%
    \pgfpathlineto{\pgfqpoint{0pt}{9\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{0\pgfutil@tempdima}{0\pgfutil@tempdima}}%  
    \pgfpathmoveto{\pgfqpoint{0\pgfutil@tempdima}{0\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{-6pt}{-6pt}}% 
    \pgfusepathqstroke%
    \pgfsetfillcolor{white}
    \pgfpathcircle{\pgfpoint{-11.5pt}{0}} {3.5pt}
    \pgfusepathqfillstroke%
}

\pgfarrowsdeclare{one}{one}
{
    \pgfarrowsleftextend{+-.5\pgflinewidth}%
    \pgfarrowsrightextend{+.5\pgflinewidth}%
}
{
    \pgfutil@tempdima=0.6pt%
    \pgfsetdash{}{+0pt}%
    \pgfsetmiterjoin%
    \pgfpathmoveto{\pgfqpoint{0\pgfutil@tempdima}{0\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{-6pt}{-6pt}}% 
    \pgfpathlineto{\pgfqpoint{-6pt}{-6pt}}%  
    \pgfpathlineto{\pgfqpoint{-6pt}{6pt}}% 
    \pgfpathmoveto{\pgfqpoint{0\pgfutil@tempdima}{0\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{-8pt}{-6pt}}% 
    \pgfpathlineto{\pgfqpoint{-8pt}{-6pt}}%  
    \pgfpathlineto{\pgfqpoint{-8pt}{6pt}}%    
    \pgfusepathqstroke%
}

\pgfarrowsdeclare{oone}{oone}
{
    \pgfarrowsleftextend{+-.5\pgflinewidth}%
    \pgfarrowsrightextend{+.5\pgflinewidth}%
}
{
    \pgfutil@tempdima=0.6pt%
    %\advance\pgfutil@tempdima by.25\pgflinewidth%
    \pgfsetdash{}{+0pt}%
    \pgfsetmiterjoin%
     \pgfpathmoveto{\pgfqpoint{0\pgfutil@tempdima}{0\pgfutil@tempdima}}%
    \pgfpathmoveto{\pgfqpoint{-4pt}{-6pt}}% 
    \pgfpathlineto{\pgfqpoint{-4pt}{-6pt}}%  
    \pgfpathlineto{\pgfqpoint{-4pt}{6pt}}% 
    \pgfsetfillcolor{white}
    \pgfpathcircle{\pgfpoint{-11.5pt}{0}} {3.5pt}
    \pgfusepathqfillstroke%
}
\makeatother

\tikzset{%
    mylabel/.style={font=\footnotesize},
    pics/entity/.style n args={3}{code={%
        \node[draw,
        rectangle split,
        rectangle split parts=2,
        text height=1.5ex,
        text width=8.5em,
        text centered
        ] (#1)
        {#2 \nodepart[font=\scriptsize]{second}
            \begin{tabular}{>{\raggedright\arraybackslash}p{9em}}
                #3
            \end{tabular}
        };%
    }},
    pics/entitynoatt/.style n args={2}{code={%
        \node[draw,
        text height=1.5ex,
        text width=8.5em,
        text centered
        ] (#1)
        {#2};%
    }},
    zig zag to/.style={
        to path={(\tikztostart) -| ($(\tikztostart)!#1!(\tikztotarget)$) |- (\tikztotarget)}
    },
    zig zag to/.default=0.5,   
    one to one/.style={
        one-one, zig zag to
    },
    one to oone/.style={% One to Optional-one
        one-oone, zig zag to
    },
    oone to none/.style={% Optional-one to none
        oone-, zig zag to
    },
    oone to oone/.style={% Optional one to Optional-one
        oone-oone, zig zag to
    },
    one to many/.style={
        one-crow's foot, zig zag to,
    },
    one to omany/.style={
        one-omany, zig zag to
    },
    one to none/.style={
        one-, zig zag to
    },    
}
\title{SpeedCola Software Design Document}
\date{\today}% Date of issue and status
\author{SpeeCola inc}% Issuing organization
\begin{document}
\maketitle
\newpage
\pagenumbering{arabic}

\section{Introducci\'on}
Scope
   Authorship (responsibility or copyright information)
   References
   Context
   One or more design languages for each design viewpoint used
   Body
   Summary
   Glossary
   Change history

  \begin{enumerate}
    \item  \textbf{Descripcion General}

  El proposito de este documento es describir tanto la arquitectura como la implementacion de 
  SpeedCola en aras de facilitar su uso, modificacion, prubeas y resolucion de errores.

  \item \textbf{Software's Scope}

  SpeedCola es una aplicacion web que facilita la conexion entre proveedores de servicio y consumidores.

  \end{enumerate}

  \subsection{In-Scope Funcitonalities}
    \begin{enumerate}
      \item \textbf{Registro y Autenticacion}
        \begin{enumerate}
          \item Los usuarios pueden crear cuentas
          \item Los usuarios pueden validar sus cuentas mediante documentos
          \item Las cuentas son autenticadas mediante correo electronico.
        \end{enumerate}
      \item \textbf{Manejo de Perfiles}
        \begin{enumerate}
          \item Los consumidores pueden crear y editar cuentas
          \item Los proveedores pueden crear  y editar cuentas
          \item Los proveedores pueden 
        \end{enumerate}
      Permite la edición de perfiles tanto de consumidores como de 
      proveedores, incluyendo información personal, experiencia y tarifas.  
      \item \textbf{Oferta de Servicios}
        Permite la creacion de 
      \item \textbf{Busqueda de Servicios}
      \item \textbf{Registro y Autenticacion}
    \end{enumerate}

      Gestiona la publicación, búsqueda y visualización de servicios disponibles. 

      Módulo de comunicación  

      Permite a los usuarios a interactuar y crear contratos mediante chats con proveedores. 

      Módulo de calificaciones y reseñas   

      Contiene la funcionalidad para la evaluación mutua entre consumidores y proveedores al finalizar un servicio.  

      Módulo de notificaciones  

      Crea y gestiona las notificaciones con un sistema basado en eventos tales como: 

      Ofertas nuevas 

      Confirmaciones de pago 

      Reseñas recibidas  

      Mensajes 
      
\section{Dise\~no General}
  
  \subsection{Arquitectura del Sistema}
    \begin{tikzpicture}

    \begin{scope}[shift={(1,1)},local bounding box=A]
    \draw (0,0) rectangle (11.3,1.5);
    \draw (0.2,0.2) rectangle (3.2,1);
    \draw (3.7,0.2) rectangle (6.7,1);
    \draw (7.2,0.2) rectangle (10.2,1);
    \node[scale=0.8] at (1.65,0.5) {$S_{x_{1}}$};
    \node[scale=0.8] at (5.5,0.5) {$S_{x_{2}}$};
    \node[scale=0.8] at (8.5,0.5) {$S_{x_{3}}$};
    \node[scale=0.8] at (10.65,0.5) {$S_{x}$};
    \end{scope}

    \draw[->] (0,0) -- (A.west);
    \end{tikzpicture}
  //todo diagrama de aws
  //todo diagrama de apis
  \subsection{Justificacion de la INfraestructura}

\section{Consideraciones Tecnicas}
\newpage

\section{Arquitectura}
\newpage


\section{Detalles del Dise\~no}
  \foreach \module in {
    internals\_sauth,
    internals\_contract,
    internals\_chat,
    internals\_browser,
    internals\_search,
    internals\_events,
    internals\_notifs }
  {
    \subsection{Modulo: \module}
    parse some yaml files with the methods etc
    \newline
    \begin{tabular}{ l l l l l  }
      \hline
      Metodo & Proposito & entrada & Salida & Status \\
      \hline
          GET & 2 & 3 & 3 & 200\\
          GET & 2 & 3 & 3 & 200\\ 
          GET & 2 & 3 & 3 & 200\\
        
      \hline
    \end{tabular}
  }
\newpage
\section{Dise\~no de los Datos}
  //poner las tablas

  \begin{landscape}
      \begin{center}
          \begin{tikzpicture}
              \pic {entity={A}{Citas}{%
                  idCita(PK): int\\
                  fecha  :date\\
                  idCliente: int \\
                  idProveedor: int \\
                  estado: int \\
                  idServicio: int
              }};

              \pic[right=7em of A] {entity={AB}{{Entity A \\ for \\ Entity B}}{%
                  attribute 1 \\
                  attribute 2
              }};
              \pic[right=7em of AB] {entity={B}{Servicios}{%
                  idServicio(PK): int\\
                  Nombre: str\\
                  Descripcion: str\\
                  Precio: str\\
                  DuracionEstimada: str\\
                  idUsuarioP: str\\
                  idCategoria: str\\
                  reseñas: 
              }};
              \pic[below=16ex of B] {entity={C}{Usuarios}{%
                  attribute 1    
              }};
              \pic[below=15ex of AB] {entitynoatt={C1}{Entity C\textunderscore 1}};
              \pic[below=9ex of C1] {entitynoatt={C2}{Entity C\textunderscore 2}};
              \draw[one to omany] (A.east) -- (AB.west);
              \node[mylabel, anchor=south east] at (A.north east) {is in};
              \draw[one to omany] (B.west) -- (AB.east);
              \node[mylabel, anchor=south west] at (B.north west) {is in};
              \draw[one to one] (B.south) -- (C.north);
              \node[mylabel, anchor=south west] at (B.south east) {is in};
              \node[mylabel, anchor=north west] at (C.north east) {is in};
              %From section 13.3 of the TikZ manual, (2,1 |- 3,4) and (3,4 -| 2,1) both yield the same as (2,4) 
              \coordinate (mymiddle) at ($(C.west)!.5!(C1.east)$);
              \coordinate (mylink) at (C.west -| mymiddle);
              \draw[one to oone] (C.west) -| (mymiddle) node[mylabel, above=10pt]{is in} |- (C1.east);  % Make "oone" rel
              \draw[oone to none] (C2.east) -|  node[mylabel, below=2pt]{is in} (mylink);
              \end{tikzpicture}
      \end{center}
  \end{landscape}
\section{Dise\~no de Interfaces}


\end{document}
